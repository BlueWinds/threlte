---
import { getLeftSidebarMenu } from './getLeftSidebarMenu'
import LeftSidebar from './LeftSidebar.svelte'

const sidebarMenu = await getLeftSidebarMenu()

const activeSidebarTab: 'learn' | 'reference' = Astro.url.pathname.startsWith('/docs/learn')
  ? 'learn'
  : 'reference'

const activeUrlPathName = Astro.url.pathname
---

<LeftSidebar
  client:load
  menu={sidebarMenu}
  activeSidebarTab={activeSidebarTab}
  activeUrlPathName={activeUrlPathName}
/>

<!-- Preserve sidebar scroll across page loads -->
<script is:inline>
{
  debugger
  const leftSidebar = document.querySelector('#sidebar-scrollwindow')
  const leftSidebarScroll = localStorage.getItem('sidebar-scroll')
  if (leftSidebarScroll !== null) {
    leftSidebar.scrollTop = parseInt(leftSidebarScroll, 10)
  }
  window.addEventListener('beforeunload', () => {
    debugger
    localStorage.setItem('sidebar-scroll', leftSidebar.scrollTop)
  })
}
</script>
